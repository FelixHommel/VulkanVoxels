name: Feature Branch Quick Check

on:
  push:
    branches: [ 'feature-**' ]

jobs:
  quick-build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Install system dependencies
        run: |
          sudo apt-get update
          sudo apt install -y \
          cmake \
          ninja-build \
          gcc-14 \
          g++-14 \
          libxrandr-dev \
          libxinerama-dev \
          libxcursor-dev \
          libxi-dev \
          libgl1-mesa-dev
      - name: Setup vckpkg
        uses: lukka/run-vcpkg@v11
        with:
          vcpkgGitCommitId: 'a42af01b72c28a8e1d7b48107b33e4f286a55ef6'
      - name: Install Vulkan SDK
        uses: humbletim/setup-vulkan-sdk@v1.2.0
        with:
          vulkan-query-version: 1.3.290.0
          vulkan-components: Vulkan-headers, Vulkan-Loader
          vulkan-use-cache: true
      - name: Quick build check
        id: build
        continue-on-error: true
        run: |
          cmake --preset debug -DCMAKE_TOOLCHAIN_FILE="${VCPKG_ROOT}/scripts/buildsystems/vcpkg.cmake"
          cmake --build --preset debug
      - name: Summary
        run: |
          echo "## Feature Branch Check Summary" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY

          if [[ "${{ steps.build.outcome }}" == "success" ]]; then
            echo "**Build**(success): Builds successfully" >> $GITHUB_STEP_SUMMARY
          else
            echo "**Build**(failure): Compilation errors found" >> $GITHUB_STEP_SUMMARY
          fi
